<!DOCTYPE html>
<html lang="es">
  <head>
    <%- include('../partials/head', { title: 'Crear cuenta | TechStore' }) %>
  </head>
  <body>
    <%- include('../partials/header') %>

    <main class="auth-container">
      <div class="auth-card">
        <div class="auth-header">
          <div class="auth-logo">TechStore</div>
          <div class="auth-decoration"></div>
        </div>

        <div class="auth-content">
          <h1 class="auth-title">Crea una cuenta</h1>
          <p class="auth-subtitle">
            Únete a nuestra comunidad tecnológica y accede a las mejores ofertas
          </p>

          <!-- Mostrar errores si existen -->
          <% if (typeof error !== 'undefined' && error) { %>
          <div class="alert alert-error">
            <p><%= error %></p>
          </div>
          <% } %>

          <form
            class="auth-form"
            action="/v2/api/usuarios/register"
            method="POST"
            id="registerForm"
          >
            <div class="form-group">
              <label for="correo">Correo electrónico</label>
              <input
                type="email"
                id="correo"
                name="correo"
                placeholder="nombre@ejemplo.com"
                required
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="documento">Documento</label>
                <input
                  type="text"
                  id="documento"
                  name="documento"
                  placeholder="1234567890"
                  required
                  minlength="7"
                  maxlength="10"
                />
              </div>
              <div class="form-group">
                <label for="fechaNacimiento">Fecha de nacimiento</label>
                <input
                  type="date"
                  id="fechaNacimiento"
                  name="fechaNacimiento"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label for="nombreCompleto">Nombre completo</label>
              <input
                type="text"
                id="nombreCompleto"
                name="nombreCompleto"
                placeholder="Tu nombre completo"
                required
              />
            </div>

            <div class="form-group">
              <label for="rol">Tipo de cuenta</label>
              <select id="rol" name="rol" required>
                <option value="">Selecciona una opción</option>
                <option value="cliente">Cliente - Comprar productos</option>
                <option value="empleado">Empleado - Gestionar tienda</option>
                <option value="admin">Administrador - Acceso completo</option>
              </select>
            </div>

            <div
              id="clienteFields"
              class="cliente-fields"
              style="display: none"
            >
              <div class="form-row">
                <div class="form-group">
                  <label for="telefono">Teléfono (opcional)</label>
                  <input
                    type="tel"
                    id="telefono"
                    name="telefono"
                    placeholder="3001234567"
                  />
                </div>
                <div class="form-group">
                  <label for="direccion">Dirección (opcional)</label>
                  <input
                    type="text"
                    id="direccion"
                    name="direccion"
                    placeholder="Calle 123 #45-67"
                  />
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="password">Contraseña</label>
              <input
                type="password"
                id="password"
                name="password"
                placeholder="Crea una contraseña segura"
                required
                minlength="8"
              />
              <div class="password-requirements">
                <small>• Al menos 8 caracteres</small>
                <small>• Una letra mayúscula</small>
                <small>• Un número</small>
                <small>• Un carácter especial (!, @, *, %, +, ?, #)</small>
              </div>
            </div>

            <div class="form-group">
              <label for="confirmPassword">Repetir contraseña</label>
              <input
                type="password"
                id="confirmPassword"
                name="confirmPassword"
                placeholder="Confirma tu contraseña"
                required
              />
            </div>

            <div class="form-checkboxes">
              <label class="checkbox-label">
                <input type="checkbox" name="terms" required />
                <span class="checkmark"></span>
                Acepto los <a href="#" class="link">términos y condiciones</a>
              </label>

              <label class="checkbox-label">
                <input type="checkbox" name="privacy" required />
                <span class="checkmark"></span>
                He leído y acepto la
                <a href="#" class="link">política de privacidad</a>
              </label>
            </div>

            <button type="submit" class="btn btn-primary btn-full">
              Crear cuenta
            </button>
          </form>

          <div class="auth-footer">
            <p>
              ¿Ya tienes una cuenta?
              <a href="/login" class="link">Iniciar sesión</a>
            </p>
          </div>
        </div>
      </div>
    </main>

    <%- include('../partials/footer') %>

    <script>
      // Validación de contraseñas en el frontend
      document
        .getElementById("registerForm")
        .addEventListener("submit", function (e) {
          const password = document.getElementById("password").value;
          const confirmPassword =
            document.getElementById("confirmPassword").value;

          if (password !== confirmPassword) {
            e.preventDefault();
            alert("Las contraseñas no coinciden");
            return false;
          }
        });

      // Mostrar/ocultar campos según el rol seleccionado
      document.getElementById("rol").addEventListener("change", function () {
        const clienteFields = document.getElementById("clienteFields");
        if (this.value === "cliente") {
          clienteFields.style.display = "block";
        } else {
          clienteFields.style.display = "none";
        }
      });
    </script>
  </body>
</html>
